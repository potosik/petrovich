"use strict";(function(){function t(){this.init=function(){this.deleteButtonConfirmation();this.searchBoxInitialization();this.purchaseDatePickerInitialization();this.inputMasksInitialization();this.smartCartInitialization()};this.deleteButtonConfirmation=function(){$(".btn-delete").click(function(){return confirm("Элемент будет безвозвратно удален\nВы уверены что хотите удалить данный элемент?")})};this.searchBoxInitialization=function(){$("#searchBox").autocomplete({source:function(n,t){jQuery.get(_pageData.fastSearchUri,{q:n.term},function(n){if(!n.Success||!n.Result){t([]);return}$.map(n.Result,function(n){n.GroupInformation=n.GroupTitle?" / "+n.GroupTitle:"";n.ImageSmall||(n.ImageSmallUri=_pageData.noImageUri)});t(n.Result)})},minLength:_pageData.fastSearchMinLength,delay:_pageData.defaultDebounce,select:function(n,t){window.location.href=t.item.SelfUri},appendTo:"#searchBoxResults",open:function(){$("#searchBoxResults > ul").css({left:"auto",right:0})}}).focus(function(){$(this).autocomplete("search",this.value)}).autocomplete("instance")._renderItem=function(n,t){var i=$("#searchBoxItemTemplate").html(),r=Mustache.to_html(i,t);return $("<li>").append(r).appendTo(n)}};this.purchaseDatePickerInitialization=function(){var f=$("#purchasePicker"),r=$("#purchasemonth"),u=$("#purchaseyear"),n=parseInt(r.val()),t=parseInt(u.val()),i=undefined;n&&t&&!isNaN(n)&&!isNaN(t)&&(i=new Date(t,n-1,1));$("#purchasePicker").datepicker({changeMonth:!0,changeYear:!0,showButtonPanel:!0,dateFormat:"MM yy",closeText:"Готово",defaultDate:i,onClose:function(n,t){r.val(t.selectedMonth+1);u.val(t.selectedYear);$(this).datepicker("setDate",new Date(t.selectedYear,t.selectedMonth,1))}});i&&f.datepicker("setDate",new Date(t,n-1,1))};this.inputMasksInitialization=function(){$("#price,#assessedvalue").inputmask("9{1,7},99",{numericInput:!0})};this.smartCartInitialization=function(){$(function(){function o(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i].unique_key===t)return i;return-1}function s(){localStorage.removeItem(n)}function r(t,i){var r=JSON.parse(localStorage.getItem(n)||"[]");r.push(i);localStorage.setItem(n,JSON.stringify(r))}function u(t,i){var r=JSON.parse(localStorage.getItem(n)||"[]"),u=o(r,i.unique_key);u>-1&&r.splice(u,1);localStorage.setItem(n,JSON.stringify(r))}var n="petrovich-smartcart-bid",t=JSON.parse(localStorage.getItem(n)||"[]"),f=$(".sc-product-item"),e=t.map(function(n){return n.product_id}),i;if(t.length>0)for(i=0;i<t.length;i++)f.each(function(){var n=$(this),t=n.find('input[name="product_id"]').val();e.indexOf(t)>-1&&n.closest(".sc-product-item").addClass("sc-added-item")});$("#smartcart").smartCart({resultName:"serializedList",cart:t});$("#smartcart").on("cartCleared",s);$("#smartcart").on("itemAdded",r);$("#smartcart").on("itemRemoved",u);$("#smartcart").on("quantityUpdated",function(n,t){u(n,t);r(n,t)})})};this.submitSmartCart=function(){$("#smartcart .sc-cart-item").length?$("#smartcart .sc-cart-checkout").click():$(".x_panel.bid.hide").removeClass("hide")}}var n=function(n,t){typeof window[n]!="function"&&(window[n]=t)};n("logout",function(){var n=document.logoutForm;n&&n.submit&&typeof n.submit=="function"&&n.submit()});window.petrovich=new t;petrovich.init()})();